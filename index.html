<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5">
  <title>Heavyweight: Letters Taken Seriously</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <link rel="icon" type="image/png" href="assets/heavyweight_favicon.png">
  <!-- preview image -->
  <meta property="og:title" content="Heavyweight: All of the gravitas, none of the fees">
  <meta property="og:description" content="Generate professional-looking demand letters with style and snootiness">
  <meta property="og:image" content="assets/heavyweight_linkpreview.png">
  <meta property="og:url" content="https://heavyweight.cc">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="assets/heavyweight_linkpreview.png">

  <!-- font imports -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Bodoni+Moda:ital,opsz,wght@0,6..96,400..900;1,6..96,400..900&family=Linden+Hill:ital@0;1&family=Noto+Serif:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
  
  <style>

    body {
        font-family: 'Noto Sans', sans-serif;
        margin: 0;
        padding: 20px;
        background-color: #f5f7fa;
        color: #333;
        /* line-height: 1.6; */
    }

    h1, h2, h3, h4, h5, h6 {
        font-family: 'Noto Serif', serif;
        margin-top: 0.5em;
        margin-bottom: 0.5em;
        color: #2c3e50;
    }

    h1 {
        font-size: 2.5rem;
        font-weight: 700;
        color: #1a237e;
        margin-top: 1rem;
        border-bottom: 2px solid #3f51b5;
        padding-bottom: 0.5rem;
        width: fit-content;
    }


    /* #main {
      display: flex;
      flex-direction: row;
      gap: 20px;
    } */

    #main {
        display: flex;
        padding: 20px;
        gap: 30px;
        max-width: 1400px;
        margin: 0 auto;
    }
    

    

    button {
        background-color: #3f51b5;
        color: white;
        border: none;
        padding: 10px 18px;
        margin: 5px;
        border-radius: 4px;
        cursor: pointer;
        font-weight: 600;
        transition: background-color 0.2s, transform 0.1s;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    button:hover {
        background-color: #303f9f;
        transform: translateY(-1px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.15);
    }

    button:active {
        transform: translateY(1px);
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }

    .siteHeader {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
    }

    .buttonContainer {
        display: flex;
        flex-direction: row;
        align-items: center;
        justify-content: center;
    }

    #inputs {
        line-height: 1.6;
        width: 40%;
        background-color: white;
        border-radius: 8px;
        padding: 25px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.25);
    }

    #inputs p {
        margin-bottom: 1rem;
    }

    input[type="text"], textarea, select {
        width: 90%;
        padding: 10px;
        margin-bottom: 15px;
        border: 1px solid #ddd;
        border-radius: 4px;
        font-size: 0.9rem;
        transition: border-color 0.2s;
    }

    input[type="text"]:focus, textarea:focus, select:focus {
        border-color: #3f51b5;
        outline: none;
        box-shadow: 0 0 0 2px rgba(63, 81, 181, 0.2);
    }

    textarea {
        min-height: 120px;
        resize: vertical;
    }

    select {
        appearance: none;
        background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%233f51b5' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");
        background-repeat: no-repeat;
        background-position: right 10px center;
        /* background-size: 16px; */
        /* padding-right: 40px; */
        width: 90%;
    }

    input[type="range"] {
        width: 90%;
        margin: 10px 0 20px 0;
        accent-color: #3f51b5;
    }


    /* #output {
      padding: 20px;
      background-color: gray;
      width: 60%;
    } */

    .output {
        padding: 25px;
        background-color: gray;
        border-radius: 8px;
        width: 60%;
        box-shadow: 0 4px 15px rgba(0,0,0,0.25);
        display: flex;
        justify-content: start;
        align-items: center;
        flex-direction: column;
        gap: 20px;
        overflow: auto;
    }

    .output::-webkit-scrollbar {
        border-radius: 8px;
        width: 4px;
        padding: 10px;
        background-color: transparent;
    }

    .output::-webkit-scrollbar-thumb {
        background-color: lightgray;
        width: 4px;
        border-radius: 10px;
    }


    .pdfPreview {
        box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        max-width: 100%;
    }


    
    #renderTarget {
      position: absolute;
      left: -9999px;
      top: 0;
      width: 210mm;
      /* height: 297mm; */
      padding-top: 20mm;
      padding-left: 20mm;
      padding-right: 20mm;
      padding-bottom: 0mm;
      background: white;
      margin-bottom: 0mm;
      /* font-family: Comic Sans MS, sans-serif; */
      /* font-family: Arial, sans-serif; */
        /* font-family: Times, serif; */
      /* font-family: Bodoni Moda, serif; */
      /* font-family: Linden Hill, serif; */
      /* TEST STUFF */
      /* border: 1px solid red; */
    }

    /* #renderTarget p {
      color: red;
    }

    #renderTarget div {
      border: 1px solid red;
    }

    #renderTarget header {
      border: 1px solid blue;
    } */


    /* template styling */

    @font-face {
        font-family: signatureFont;
        src: url("assets/signaturefont.ttf");
    }

    


    .senderSignature {
      font-family: signatureFont, cursive;
      font-size: 84px;
      margin: -20px;
    }

    .senderName {
        margin-bottom: 0px;
    }

    .template1 {
      /* border: 1px solid green; */
      /* font-family: 'Times New Roman', Times, serif; */
      font-size: 18px;
    }

    .template1 span {
        margin: 0;
    }

    .template1 .firmName {
        font-size: 24px;
        text-align: center;
    }
    .template1 .firmAddress {
        /* border: 1px solid yellow; */
        text-align: center;
        align-items: center;
        margin-bottom: 10px;

    }

    .template1 .addressLine {
      margin: 0;
    }
    
    /* .template1 .firmPartners {
        display: flex;
        flex-direction: column;
        flex-wrap: wrap;
        align-self: flex-end;
        gap: 0px 40px;
    }
 */

 .template1 .firmPartners {
        display: flex;
        flex-direction: column;
        align-self: flex-end;
        gap: 0px;
        width: 100%;
    }

    .template1 .firmPartners.two-columns {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 0px 40px;
        width: 100%;
        text-align: right;
    }

    .template1 .firmPartners.three-columns {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        gap: 0px 40px;
        width: 100%;
        text-align: right;
    }

    .template1 .firmPartners.four-columns {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr 1fr;
        gap: 0px 30px;
        width: 100%;
        text-align: right;
    }

    .template1 .firmPartners.five-columns {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr 1fr 1fr;
        gap: 0px 25px;
        width: 100%;
        text-align: right;
    }

    .firmPartner {
        margin: 0;
        align-self: flex-end;
    }
    .template1 .date {
        margin-top: 10px;
      align-self: flex-end;
    }
    
    .template1 .letterFooter {
      margin-top: 10px;
      align-self: flex-end;
      text-align: left;
    }
    .template1 .letterFooter .senderSignature {
      margin-left: 15px;
    }

    @media only screen and (max-width: 900px) {
        #main {
            flex-direction: column;
            /* flex-direction: column-reverse; */
        }
        #inputs {
            width: 90%;
        }
        #output {
            width: 90%;
        }
    }

    
  </style>

  <script>  

        //this is diy alternative to a google analytics
      //it only logs IP (for calcultating unique views) and event type
      //there are two event types: home page load and pdf download
      //pls do not spam I just want to know how many ppl use my site
      //you can view the source code at https://github.com/we-make-internet/home-page/blob/main/www/diyPixel/heavyweightPixel.php
      fetch('https://wemakeinter.net/diyPixel/heavyweightPixel.php?event=pageView')


    let imageData = null;


    const exampleRecipients = {
        delta : {
            recipientName: "Delta Airlines",
            recipientAddressLine1: "1010 Delta Blvd.",
            recipientAddressLine2: "Atlanta, GA, 30354",
            recipientAddressLine3: "United States",
            reSubject: "Flight Refund",
            textBody: "Complain about your flight here. \n\nLorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.",
        },
        amazon : {
            recipientName: "Amazon Services LLC",
            recipientAddressLine1: "410 Terry Ave N",
            recipientAddressLine2: "Seattle, WA, 98101",
            recipientAddressLine3: "United States",
            reSubject: "Amazon Refund",
            textBody: "Complain about your Amazon experience here. \n\nLorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.",
        },
        tesla : {
            recipientName: "Tesla HQ",
            recipientAddressLine1: "1 Tesla Rd",
            recipientAddressLine2: "Austin, TX, 78725",
            recipientAddressLine3: "United States",
            reSubject: "Tesla Refund",
            textBody: "Complain about your Tesla experience here. \n\nLorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.",
        }
    ,
    landlord : {
        recipientName: "Greta Realjahb",
        recipientAddressLine1: "450 Harman St",
        recipientAddressLine2: "Unit B",
        recipientAddressLine3: "Brooklyn, New York",
        reSubject: "Hot Water Issues at 450 Harman St",
        textBody: "Morry Kolman resides at your property at 450 Harman St. Since April 15, 2025, Mr. Kolman's apartment has not had consistent water pressure or hot water. On many days, including but not limited to April 15, April 17, April 19, April 22, April 25, April 27, May 2, May 4, and May 5, the water coming out of Mr. Kolman's showerhead was a cold trickle.\n\nUnder New York law, you have an obligation to provide a livable, safe, and sanitary apartment. The failure to provide Mr. Kolman with hot water violates this obligation. Mr. Kolman previously notified you on April 20, 2025 of the persistent issues with the shower, but the situation has not improved.\n\nPlease send out a maintenance person to fix the issue with the hot water and water pressure immediately. Once those repairs are complete, we are willing to negotiate what percentage of rent should be discounted for the relevant period.\n\nWe look forward to your prompt reply. Mr. Kolman reserves all rights."
    },
    workplace : {
        recipientName: "Karen Anderson",
        recipientAddressLine1: "OCF Coffeehouse",
        recipientAddressLine2: "1575 Roundhouse Road",
        recipientAddressLine3: "San Antonio, Texas",
        reSubject: "Wage and Hour Violations",
        textBody: "It has come to my attention that workers at OCF Coffeehouse have not been receiving overtime pay for hours worked in excess the allowed amount. Your categorization of baristas as exempt, despite the fact that they are not salaried and make less than $40K per year is likely a violation of state and federal law. Additionally, suggesting that baristas should clock out even though they still have cleaning tasks to perform is flagrantly illegal.\n\nOCF Coffeehouse's baristas are beloved members of our local community. Jane volunteers at the animal shelter between shifts, whereas Olive is an integral part of the local aerials group. They deserve a workplace that recognizes their contributions and pays them appropriately.\n\nWe look forward to your response, including a complete list of the payments you plan to provide to each staff member. We, of course, reserve all rights."
    },
    client : {
        recipientName: "[Your Client]",
        recipientAddressLine1: "[Client address line 1]",
        recipientAddressLine2: "[Client address line 2]",
        recipientAddressLine3: "[Client address line 3]",
        reSubject: "[Your Subject]",
        textBody: "I write to you on behalf of [Your Name], who you contracted to provide freelance work. [Your Name] signed a contract with you on [Contract Date] specifying the terms of their engagement. Specifically, they would be paid [Payment Amount] for [Service Rendered].\n[Your Name] invoiced [Company] on [Invoice Date], with invoice terms of [Invoice Term]. That invoice is now past due, and [Your Name] has not received payment.\nPlease remit payment immediately. If [Company] fails to pay, [Your Name] reserves the right to pursue all legal remedies, including pursuit of any damages that have come from your failure to pay in a timely fashion."
    },
    securityDeposit : {
        recipientName: "[Your Landlord]",
        recipientAddressLine1: "[Landlord address line 1]",
        recipientAddressLine2: "[Landlord address line 2]",
        recipientAddressLine3: "[Landlord address line 3]",
        reSubject: "Security Deposit Request",
        textBody: "[YOUR NAME] formally requests the immediate return of their $[AMOUNT] security deposit for the property at [OLD ADDRESS], which they vacated on [MOVE OUT DATE]. You are now past the deadline for returning security deposits, which under the terms of the lease was due [SECURITY DEPOSIT DUE DATE].\nAs of today you have not returned their deposit or provided an itemized list of deductions. Therefore, [YOUR NAME] is requesting the full return of their deposit.\n\nPlease send the total deposit of $[AMOUNT] to [YOUR NEW ADDRESS] within 7 days of this letter to settle this matter promptly. [YOUR NAME] reserves all rights."
    },
    securityDeposit : {
        recipientName: "[Your Landlord]",
        recipientAddressLine1: "[Landlord address line 1]",
        recipientAddressLine2: "[Landlord address line 2]",
        recipientAddressLine3: "[Landlord address line 3]",
        reSubject: "Security Deposit Request",
        textBody: "[YOUR NAME] formally requests the immediate return of their $[AMOUNT] security deposit for the property at [OLD ADDRESS], which they vacated on [MOVE OUT DATE]. You are now past the deadline for returning security deposits, which under the terms of the lease was due [SECURITY DEPOSIT DUE DATE].\nAs of today you have not returned their deposit or provided an itemized list of deductions. Therefore, [YOUR NAME] is requesting the full return of their deposit.\n\nPlease send the total deposit of $[AMOUNT] to [YOUR NEW ADDRESS] within 7 days of this letter to settle this matter promptly. [YOUR NAME] reserves all rights."
    },

    }

    const addresses = [
        ['Boylston St.', 'Boston, MA, 02116'],
        ['E Wolf Point Plaza', 'Chicago, IL , 60606'],
        ['Louisiana St.', 'Houston, TX, 77002'],
        ['Avenue of the Stars', 'Los Angeles, CA, 90067'],
        ['6th Ave', 'New York, NY, 10019'],
        ['University Ave.', 'Palo Alto, CA, 94301'],
        ['New York Ave., NW', 'Washington, DC, 20005'],
        ['Lexington Ave', 'New York, NY, 10022'],
        ['Century Park East', 'Los Angeles, CA, 90067'],
        ['K Street, NW', 'Washington, DC, 20006'],
        ['Avenue of the Americas', 'New York, NY, 10020'],
        ['State Street', 'Boston, MA, 02109'],
        ['South Biscayne Boulevard', 'Miami, FL, 33131']
    ]

    const nameSources = {
        mayflower : {
            first: ['John', 'Ellen', 'John', 'Francis', 'Christopher', 'Mary', 'Solomon', 'William', 'Joseph', 'Priscilla', 'Robert', 'Alice', 'Miles', 'Rose', 'Francis', 'Sarah', 'Samuel', 'Stephen', 'Elizabeth', 'Giles', 'Constance', 'Damaris', 'Oceanus', 'Edward', 'Richard', 'Edmond', 'Peter', 'Robert', 'Giles', 'Thomas', 'Andrew', 'Catherine', 'Desire', 'Roger', 'William', 'Jasper', 'Dorothy', 'Edward', 'Elizabeth', 'George', 'Elias', 'Gilbert', 'Love', 'Wrestling', 'Richard', 'Isaac', 'Bartholomew', 'Remember', 'Susanna', 'Resolved', 'Agnus', 'Henry', 'Humility', 'Joan', 'Ann', 'James', 'Moses', 'Digory'],
            last: ['Billington', 'Martin', 'Prower', 'Langemore', 'Mullins', 'Carter', 'Rigsdale', 'Standish', 'Eaton', 'Hopkins', 'Fisher', 'Doten', 'Leister', 'Britteridge', 'Clarke', 'Gardiner', 'Margeson', 'Brown', 'Warren', 'Jones', 'Alden', 'Coppin', 'Heale', 'English', 'Allerton', 'Parker', 'Trevore', 'Williamson', 'Carver', 'White', 'Minter', 'Howland', 'Wilder', 'Latham', 'More', 'Bradford', 'May', 'Winslow', 'Barker', 'Soule', 'Story', 'Brewster', 'Norris', 'Hooke', 'Jackson', 'Holbeck', 'Thompson', 'Tilley', 'Cooper', 'Sampson', 'Hurst', 'Cook', 'Rogers', 'Tinker', 'Fuller', 'Turner', 'Chilton', 'Crackstone']
        },
        greenwich : {
            first : ['Michael', 'Patricia', 'Thomas', 'Javier', 'Francia', 'Craig', 'Gerald', 'Jennifer', 'Debbie', 'Hector', 'Katharine', 'Walter', 'Jillian', 'Seth', 'Hale', 'Isra', 'Lisa', 'Sally', 'Eric', 'Kimberly', 'Andrea', 'Maria', 'John', 'Ellen', 'Edward', 'Adam', 'Gregory', 'Joshua', '', 'Francis', 'Margaret', 'Marilyn', 'Glen', 'Jill', 'James', 'Ronald', 'Robert', 'Claudia', 'Nicole', 'Linda', 'Christopher', 'Donald', 'Charles', 'Stephanie', 'Allyson', 'Peter', 'Keith', 'Valerie', 'Barbara', 'Blake', 'Christina', 'Carol', 'Alice', 'Elizabeth', 'Christine', 'Laura', 'Tiffany', 'Morgan', 'Susan', 'Frederick', 'Douglas', 'Pamela', 'Noah', 'Mary', 'Dawn', 'Allison', 'Tracy', 'William', 'Lynn', 'Marianne', 'Donna', 'Paul', 'Alison', 'Karen', 'Dean', 'Amaris', 'Hilary', 'Ogden', 'Ingrid', 'Sandra', 'Ramya', 'Daniel', 'Samuelle', 'Coline', 'Jonathan', 'Cathleen', 'Joseph', 'Myra', 'Jan', 'Lucy', 'Genevieve', 'Julia', 'Abbe', 'Kathleen', 'Sharon', 'Brigitte', 'Martin', 'Aaron', 'David', 'Nan', 'Mark', 'Lindy', 'Katherine', 'Rosemarie', 'Brian', 'Abigail', 'Janet', 'Jaysen', 'Stephen', 'Richard', 'Anthony', 'Noelle', 'Victoria', 'Cheryl', 'Ammar', 'Rosalind', 'Kristen', 'Lauren', 'Sean', 'Andrew', 'Jane', 'Vinay', 'Averardo', 'Aakash', 'Sylvester', 'Sheila', 'Kara', 'Nerlyn', 'Alexander', 'Jocelyn', 'Caryn', 'Chloe', 'Samuel', 'Felice', 'Geralyn', 'Steven', 'Diego', 'Sophia', 'Ferdinando', 'Vernon', 'Pragati', 'Cathryn', 'Joanne', 'Louisa', 'Amelia', 'Joyce', 'Joan', 'Maya', 'Jeffrey', 'Karsten', 'Alexis', 'Erika', 'Michelle', 'Catherine', 'Stacey', 'Jordan', 'Cliff', 'Stacy', 'Bonnie'],
            last: ['Acerbo', 'Aleman', 'Amundson', 'Anderson', 'Andrews', 'Appelbaum', 'Arzeno', 'Ashworth', 'Auch', 'Aufderheide', 'Bacon', 'Bayram', 'Edmundson', 'Bednar', 'Behringer', 'Beiley', 'Blank', 'Blume', 'Bocchino', 'Bologna', 'Brennan-Galvin', 'Broadhurst', 'Brodsky', 'Brown', 'Brumberg', 'Burgweger', 'Butler', 'Cahill', 'Cahn', 'Canner', 'Capalbo', 'Capparelle', 'Carosella', 'Carroll', 'Carter', 'Carthaus', 'Casson', 'Chaney', 'Chapman', 'Chaudhri', 'Cochran', 'Colford', 'Collins', 'Conway', 'Costello', 'Cowie', 'Cowin', 'Cruikshank', 'Dadakis', 'Damsky', 'Darula', 'DeFelice', 'Delany', 'Devaney', 'Dietrich', 'Downey', 'Ducret', 'Duff', 'Eckert', 'Edwards', 'Estevez', 'Evangelista', 'Evans', 'Feldman', 'Fenton', 'Ferraro', 'Finn', 'Finz', 'Flynn', 'Fontana', 'Fortunato', 'Frantz', 'Freedman', 'Galindo', 'Galvin', 'Garelick', 'Gaudioso-Zeale', 'Genvovese', 'Ghiorse', 'Giannuzzi', 'Gladstone', 'Goldstein', 'Goss', 'Guadalupe', 'Gunn', 'Hammond', 'Hang', 'Haroche', 'Harris', 'Shaye', 'Hindman', 'Hopley', 'Terese', 'Jones', 'Kantor', 'Cate', 'Keller', 'Kelly', 'Klein', 'Klockenbrink', 'Kniffen', 'Krasnor', 'Genny', 'Lane', 'Langel', 'Large', 'Kate', 'Lazar', 'Leader', 'Lee', 'Leibrock', 'Leonard', 'Levine', 'Levy', 'Lewis', 'Lilien', 'LoBalbo', 'Mac', 'Macaluso', 'Malin', 'McCarthy', 'McDaniel', 'Medhurst', 'Merrill', 'Meskers', 'Bill', 'Sanders', 'Montier', 'Moor', 'Moore', 'Spencer', 'Moss', 'Murad', 'Murdock', 'Myer', 'Neuman', 'Nicastro', 'Niemynski',  'Olesen', 'Olmsted', 'Brash', 'Pande', 'Parsons', 'Pascarella', 'Patel', 'Pecora', 'Pell', 'Perloe', 'Phelan', 'Philbin', 'Pierson', 'Popp', 'Porricelli', 'Riddle', 'Rogers', 'Rosenbaum', 'Rosenfeld', 'Rovelli', 'Rubin', 'Molly', 'Samponaro', 'Sanchez', 'Scarpelli', 'Schiro', 'Schwartz', 'Shankman', 'Snyder', 'Soler', 'Soni', 'Sprung', 'Cathy', 'Steinhart', 'Stone', 'Sulich', 'Sullivan', 'Szabo', 'Jay', 'Thakor', 'Tichio', 'Tobin', 'Dyer', 'Treibick', 'Urdang', 'Vagner', 'Van', 'Brachel', 'Voulgaris', 'Vranos', 'Walsh', 'Waters', 'Waugh', 'Weisbecker', 'West', 'Whitaker', 'Widlitz', 'Winston', 'Yarett', 'Yonce', 'Young', 'Zarrilli', 'Zorthian']
        },
        enron : {
            first : ['Philip', 'John', 'Harpreet', 'Robert', 'Susan', 'Eric', 'Don', 'Sally', 'Robert', 'Lynn', 'Sandra', 'Rick', 'Larry', 'Mike', 'Michelle', 'Monika', 'Shelley', 'Sean', 'Martin', 'Jeff', 'Dana', 'Craig', 'David', 'James', 'Stacy', 'Lindy', 'Tom', 'Chris', 'Frank', 'Daren', 'Mary', 'John', 'Drew', 'Lisa', 'Randall', 'Tracy', 'Chris', 'Douglas', 'Daron', 'John', 'Michael', 'Mark', 'Mark', 'Mary', 'Steven', 'Rod', 'Marie', 'Scott', 'Juan', 'John', 'Keith', 'Stanley', 'Kevin', 'Dan', 'Tana', 'Vince', 'Steven', 'Peter', 'Kam', 'Jeff', 'Louise', 'Tori', 'John', 'Kenneth', 'Matthew', 'Andrew', 'Eric', 'Michelle', 'Teb', 'Phillip', 'Paul', 'Michael', 'Kay', 'Thomas', 'Lawrence', 'Danny', 'Mike', 'Bradley', 'Jonathan', 'Errol', 'Steven', 'Albert', 'Patrice', 'Matthew', 'Scott', 'Gerald', 'Stephanie', 'Joe', 'Susan', 'Debra', 'Vladi', 'Phillip', 'Kevin', 'Joe', 'Dutch', 'Bill', 'Jay', 'Cooper', 'Andrea', 'Richard', 'Robin', 'Benjamin', 'Kevin', 'Elizabeth', 'Eric', 'Holden', 'Monique', 'Richard', 'Diana', 'Darrell', 'Jim', 'Susan', 'Cara', 'Sara', 'Jeffrey', 'Richard', 'Hunter', 'Jeffery', 'Ryan', 'Matt', 'Geir', 'Steven', 'Theresa', 'Carol', 'James', 'Joe', 'Chris', 'Geoffery', 'Fletcher', 'Mike', 'Kate', 'Mark', 'Jane', 'Paul', 'Judy', 'Barry', 'Kim', 'Kimberly', 'Charles', 'Lawrence', 'Stacey', 'Mark', 'Jason', 'William', 'Jason', 'Paul', 'Andy', 'John'],
            last : ['Allen', 'Arnold', 'Arora', 'Badeer', 'Bailey', 'Bass', 'Baughman', 'Beck', 'Benson', 'Blair', 'Brawner', 'Buy', 'Campbell', 'Carson', 'Cash', 'Causholli', 'Corman', 'Crandall', 'Cuilla', 'Dasovich', 'Davis', 'Dean', 'Delainey', 'Derrick', 'Dickson', 'Donoho', 'Donohoe', 'Dorland', 'Ermis', 'Farmer', 'Fischer', 'Forney', 'Fossum', 'Gang', 'Gay', 'Geaccone', 'Germany', 'Gilberth-Smith', 'Giron', 'Giffith', 'Grigsby', 'Guzman', 'Haedicke', 'Hain', 'Harris', 'Hayslett', 'Heard', 'Hendrickson', 'Hernandez', 'Hodge', 'Holst', 'Horton', 'Hyatt', 'Hyvl', 'Jones', 'Kaminski', 'Kean', 'Keavey', 'Keiser', 'King', 'Kitchen', 'Kuykendall', 'Lavorato', 'Lay', 'Lenhart', 'Lewis', 'Linder', 'Lokay', 'Lokey', 'Love', 'Lucci', 'Maggi', 'Mann', 'Martin', 'May', 'McCarty', 'McConnell', 'Mckay', 'Mckay', 'McLaughlin', 'Merriss', 'Meyers', 'Mims-Thurston', 'Motley', 'Neal', 'Nemec', 'Panus', 'Parks', 'Pereira', 'Perlingiere', 'Pimenov', 'Platter', 'Presto', 'Quenet', 'Quigley', 'Rapp', 'Reitmeyer', 'Richey', 'Ring', 'Ring', 'Rodrigue', 'Rogers', 'Ruscitti', 'Sager', 'Saibi', 'Salisbury', 'Sanchez', 'Sanders', 'Scholtes', 'Schoolcraft', 'Schwieger', 'Scott', 'Semperger', 'Shackleton', 'Shankman', 'Shapiro', 'Shively', 'Skilling', 'Slinger', 'Smith', 'Solberg', 'South', 'Staab', 'St. Clair', 'Steffes', 'Stepenovitch', 'Stokley', 'Storey', 'Sturm', 'Swerzbin', 'Symes', 'Taylor', 'Tholt', 'Thomas', 'Townsend', 'Tycholiz', 'Ward', 'Watson', 'Weldon', 'Whalley', 'White', 'Whitt', 'Williams', 'Williams', 'Wolfe', 'Zipper', 'Zufferli']
        }, 
        dressage : {
            first: ['Belinda', 'Susan', 'Heather', 'Robert', 'Charlotte', 'Allison', 'Sloan', 'Robert', 'Kyra', 'Jackie', 'Jan', 'Patricia', 'Laura', 'Lendon', 'Hilda', 'Marjorie', 'Frank', 'Guy', 'Tami', 'Ashley', 'Courtney', 'Isaac', 'Carol', 'Libby', 'Adrienne', 'Anna', 'Edith', 'Debbie', 'Karen', 'Alvin', 'Dorothy', 'Leslie', 'Mikala', 'Jessica', 'Marcus', 'Hartmann', 'Annie', 'Kasey', 'Steffen', 'Lars', 'Sandy', 'Donnan', 'Michael', 'Rick', 'Jane', 'Sabine', 'Guenter', 'Lynn', 'Kate', 'Lois', 'Earl', 'Christine', 'Roxanne', 'Sarah', 'Hiram', 'Elaine', 'Lisa', 'John'],
            last: ['Baudin', 'Blinks', 'Blitz', 'Borg', 'Bredahl', 'Brock', 'Doak', 'Dover', 'Downton', 'Ducci', 'Ebeling', 'Galvin', 'Graves', 'Gray', 'Gurney', 'Haines', 'Henry', 'Henry', 'Hoag', 'Holzer', 'King-Dye', 'Kitts', 'Lavell', 'Locke', 'Lyle', 'Marek', 'Master', 'McDonald', 'McIntosh', 'Moore', 'Morkis', 'Morse', 'Münter', 'Newberry-Ransehousen', 'Orlob', 'Pauly', 'Peavy', 'Perry-Glass', 'Peters', 'Petersen', 'Pflueger', 'Plumb', 'Poulin', 'Rockefeller-Silvia', 'Savoie', 'Schut-Kery', 'Seidel', 'Seidemann', 'Shoemaker', 'Stephens', 'Foster Thomson', 'Traurig', 'Trunnell', 'Tubman', 'Tuttle', 'Watt', 'Wilcox', 'Winnett']
        }, 
        declarationSigners : {
            first: ['John', 'Josiah', 'William', 'Matthew', 'Samuel', 'John', 'Robert', 'Elbridge', 'Stephen', 'William', 'Roger', 'Samuel', 'William', 'Oliver', 'Philip', 'Francis', 'Lewis', 'Richard', 'John', 'Francis', 'John', 'Abraham', 'Robert', 'Benjamin', 'Benjamin', 'John', 'George', 'James', 'George', 'James', 'George', 'Caesar', 'George', 'Thomas', 'Samuel', 'William', 'Thomas', 'Charles', 'George', 'Richard', 'Thomas', 'Benjamin', 'Thomas', 'Francis', 'Carter', 'William', 'Joseph', 'John', 'Edward', 'Thomas', 'Thomas', 'Arthur', 'Button', 'Lyman', 'George'],
            last: ['Hancock', 'Bartlett', 'Whipple', 'Thornton', 'Adams', 'Adams', 'Treat Paine', 'Gerry', 'Hopkins', 'Ellery', 'Sherman', 'Huntington', 'Williams', 'Wolcott', 'Livingston', 'Lewis', 'Morris', 'Stockton', 'Witherspoon', 'Hopkinson', 'Hart', 'Clark', 'Morris', 'Rush', 'Franklin', 'Morton', 'Clymer', 'Smith', 'Taylor', 'Wilson', 'Ross', 'Rodney', 'Read', 'McKean', 'Chase', 'Paca', 'Stone', 'Carroll', 'Wythe', 'Henry Lee', 'Jefferson', 'Harrison', 'Nelson', 'Lightfoot Lee', 'Braxton', 'Hooper', 'Hewes', 'Penn', 'Rutledge', 'Heyward', 'Lynch', 'Middleton', 'Gwinnett', 'Hall', 'Walton'
            ]
        }
    }

    const fontFamily = ['Comic Sans MS', 'Arial', 'Times', 'Bodoni Moda', 'Linden Hill']

    let variables = {
        snootiness: 3,
        format: {
            1: "A4",
            2: "Letter"
        },
        logo : {
            letters : "DCH",
            box: {
                color: "red",
                direction: "left"
            }
        },
        userName: "John Doe",
        userTitle: "Mr.",
        recipientName: "Recipient Name",
        recipientTitle: "Recipient Title",
        recipientAddressLine1: "102 Main Street",
        recipientAddressLine2: "Apt 39",
        recipientAddressLine3: "Cambridge, MA, 02138",
        reSubject: "Subject",
        firmPartnersNames : ["George Dewey", "John Cheatem", "Amanda Howe"],
        firmPartnersSource: "greenwich",
        firmName: "Nammeeee",
        firmYear: "1893",
        firmFloor: 4,
        firmAddressLine1: "5 John F. Kennedy St.",
        firmAddressLine2: "4th Floor",
        firmAddressLine3: "Cambridge, MA, 02138",
        firmPhone: "123-456-7890",
        salutation: "To whom it may concern,",
        textBody: "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.",
        closing: "Sincerely,",
        senderName: "Morry Kolman"   
    }
  </script>
</head>
<body>
    <header id="siteHeader" class="siteHeader">
        <h1>Heavyweight</h1>
        <h2 style="text-align: center"><i>All of the gravitas, none of the fees</i></h2>
        <br/>
        <p style="text-align: center;">Heavyweight lets you create important-looking letters in seconds.
        <br/>
        <br/>
        Demand respect and get results by commanding the look of authority, without the price of one.</p>
        <p><a href="./about.html">Learn more</a></p>
        <div class="buttonContainer" id="buttonContainer">
            <button onclick="generatePDF()">Update PDF</button>
            <button onclick="downloadPDF()">Download PDF</button>
            <button onclick="uploadPDF()">Upload PDF</button>
        </div>
    </header>
    <div id="main" class="main">
    <div id="inputs" class="inputs">
        <!-- <div id="exampleButtonContainer" class="exampleButtonContainer">
            <select id="exampleSelect" class="exampleSelect" onchange="prefillRecipient(this.value)">
                <option value="custom">Custom</option>
                <option value="delta">Delta</option>
                <option value="amazon">Amazon</option>
                <option value="tesla">Tesla</option>
            </select>
        </div> -->
    <h4>Recipient: Who are you sending this letter to?</h4>
    <div id="prefillButtonContainer" class="prefillButtonContainer">
        <select id="prefillSelect" class="prefillSelect" onchange="prefillRecipient(this.value)">
            <option value="custom">Custom</option>
            <option value="delta">Delta</option>
            <option value="amazon">Amazon</option>
            <option value="tesla">Tesla</option>
            <option value="landlord">Landlord Repair Request (example)</option>
            <option value="workplace">Workplace (example)</option>
            <option value="client">Overdue Client (Generic Template)</option>
            <option value="client">Security Deposit Request (Generic Template)</option>
        </select>
    </div>
      <input type="text" id="recipientInput" placeholder="Recipient Name"><br/>
      <!-- <input type="text" id="recipientTitleInput" placeholder="Recipient Title"><br/> -->
      <input type="text" id="recipientAddressLine1Input" placeholder="Recipient Address Line 1"><br/>
      <input type="text" id="recipientAddressLine2Input" placeholder="Recipient Address Line 2"><br/>
      <input type="text" id="recipientAddressLine3Input" placeholder="Recipient Address Line 3">

      <h4>Topic: What is the subject of this letter?</h4>
      <input type="text" id="reSubjectInput" placeholder="Subject"><br/>
      <textarea id="textBodyInput" placeholder="Letter Body"></textarea>
            <h4>Firm: Who is sending this letter?</h4>
            <span>Snootiness:</span> <span id="snootinessNumber"></span>
            <input type="range" id="snootinessInput" min="1" max="5" value="3">
            <br/>
            <span># of Partners:</span> <span id="nameNumberNumber"></span>
            <br/>
            <input type="range" id="nameNumberInput" min="0" max="69" value="3">
            <br/>
            <span>Floor:</span> <span id="firmFloorNumber"></span>
            <br/>
            <input type="range" id="firmFloorInput" min="1" max="100" value="30">
            <br/>
            <span>Age of firm:</span> <span id="firmAgeNumber"></span>
            <br/>
            <input type="range" id="firmAgeInput" min="1" max="250" value="69">
            <br/>
            <span>What is the source of the names?</span>
            <br/>
      <select id="nameSourceInput">
        <option value="mayflower">Mayflower Manifest</option>
        <option value="greenwich">Greenwich, CT. Town Representatives</option>
        <option value="enron">Enron Executives</option>
        <option value="dressage">Equestrian Riders</option>
        <option value="declarationSigners">Declaration of Independence</option>
      </select>

      <div style="display: none">

          <h4>You: Who are they writing on behalf of?</h4>
          <select id="userTitleInput">
              <option value="Mr.">Mr.</option>
              <option value="Ms.">Ms.</option>
              <option value="Mx.">Mx.</option>
            </select>
            <input type="text" id="userNameInput" placeholder="Your Name"><br/>
        </div>
    

      <button onclick="generatePDF()">Update PDF</button>

      <div id="content" style="width: 210mm; height: 297mm; padding: 20mm; background: white; display: none">
        <div id="pageContent" class="template1">

            <header id="pageHeader" class="pageHeader">
                <div id="firmName" class="firmName">
                    Nammeeee
                </div>
                <div id="firmYear" class="firmYear"></div>
                <div id="firmAddress" class="firmAddress">
                    <span class="addressLine" id="firmAddressLine1">Addressssss</span>,
                    <span class="addressLine" id="firmAddressLine2">Addressssss</span>
                    <br/>
                    <span class="addressLine" id="firmAddressLine3">Addressssss</span>
                </div>
                <div id="firmPartners" class="firmPartners">
                </div>
                <span id="date" class="date"></span>
            </header>
            <div id="recipient">
                <p id="recipientName" class="recipientName">Recipient Name</p>
                <p id="recipientAddress" class="recipientAddress">Recipient Address</p>
            </div>
            <div id="letterContent">
                <p id="reSubject" class="reSubject"><b>Subject</b></p>
                <p id="salutation" class="salutation">To whom it may concern,</p>
                <p id="textBody" class="textBody"></p>
            </div>
            <br/>
            <div id="letterFooter" class="letterFooter">
                <p id="closing" class="closing">Sincerely,</p>
                <p id="senderSignature" class="senderSignature">John Doe</p>
                <p id="senderName" class="senderName">John Doe</p>
            </div>
        </div>
      </div>
    </div>

    <div id="output" class="output">
      <img id="pdfPreview" class="pdfPreview" style="max-width:100%">
    </div>
  </div>

  <!-- Offscreen content for rendering -->
  <div id="renderTarget"></div>

  <script>
    const { jsPDF } = window.jspdf;

    let addressToUse = addresses[Math.floor(Math.random() * addresses.length)];
    variables.firmAddressLine1 = `${Math.floor(Math.random() * 10000)} ${addressToUse[0]}`;
    variables.firmAddressLine2 = `Floor ${15 * variables.snootiness + Math.floor(Math.random() * 30 + 1)}`;
    variables.firmAddressLine3 = `${addressToUse[1]}`;

    //FORM FUNCTIONS

    const prefillRecipient = (source) => {
        switch(source) {
        case 'custom':
            document.getElementById('recipientInput').value = '';
            document.getElementById('recipientAddressLine1Input').value = '';
            document.getElementById('recipientAddressLine2Input').value = '';
            document.getElementById('recipientAddressLine3Input').value = '';
            document.getElementById('reSubjectInput').value = '';
            document.getElementById('textBodyInput').value = '';
            break;
        case 'delta':
            document.getElementById('recipientInput').value = exampleRecipients.delta.recipientName;
            document.getElementById('recipientAddressLine1Input').value = exampleRecipients.delta.recipientAddressLine1;
            document.getElementById('recipientAddressLine2Input').value = exampleRecipients.delta.recipientAddressLine2;
            document.getElementById('recipientAddressLine3Input').value = exampleRecipients.delta.recipientAddressLine3;
            document.getElementById('reSubjectInput').value = exampleRecipients.delta.reSubject;
            document.getElementById('textBodyInput').value = exampleRecipients.delta.textBody;
            break;
        case 'amazon':
            document.getElementById('recipientInput').value = exampleRecipients.amazon.recipientName;
            document.getElementById('recipientAddressLine1Input').value = exampleRecipients.amazon.recipientAddressLine1;
            document.getElementById('recipientAddressLine2Input').value = exampleRecipients.amazon.recipientAddressLine2;
            document.getElementById('recipientAddressLine3Input').value = exampleRecipients.amazon.recipientAddressLine3;
            document.getElementById('reSubjectInput').value = exampleRecipients.amazon.reSubject;
            document.getElementById('textBodyInput').value = exampleRecipients.amazon.textBody;
            break;
        case 'tesla':
            document.getElementById('recipientInput').value = exampleRecipients.tesla.recipientName;
            document.getElementById('recipientAddressLine1Input').value = exampleRecipients.tesla.recipientAddressLine1;
            document.getElementById('recipientAddressLine2Input').value = exampleRecipients.tesla.recipientAddressLine2;
            document.getElementById('recipientAddressLine3Input').value = exampleRecipients.tesla.recipientAddressLine3;
            document.getElementById('reSubjectInput').value = exampleRecipients.tesla.reSubject;
            document.getElementById('textBodyInput').value = exampleRecipients.tesla.textBody;
            break;
        case 'landlord':
            document.getElementById('recipientInput').value = exampleRecipients.landlord.recipientName;
            document.getElementById('recipientAddressLine1Input').value = exampleRecipients.landlord.recipientAddressLine1;
            document.getElementById('recipientAddressLine2Input').value = exampleRecipients.landlord.recipientAddressLine2;
            document.getElementById('recipientAddressLine3Input').value = exampleRecipients.landlord.recipientAddressLine3;
            document.getElementById('reSubjectInput').value = exampleRecipients.landlord.reSubject;
            document.getElementById('textBodyInput').value = exampleRecipients.landlord.textBody;
            break;
        case 'workplace':
            document.getElementById('recipientInput').value = exampleRecipients.workplace.recipientName;
            document.getElementById('recipientAddressLine1Input').value = exampleRecipients.workplace.recipientAddressLine1;
            document.getElementById('recipientAddressLine2Input').value = exampleRecipients.workplace.recipientAddressLine2;
            document.getElementById('recipientAddressLine3Input').value = exampleRecipients.workplace.recipientAddressLine3;
            document.getElementById('reSubjectInput').value = exampleRecipients.workplace.reSubject;
            document.getElementById('textBodyInput').value = exampleRecipients.workplace.textBody;
            break;
        case 'client':
            document.getElementById('recipientInput').value = exampleRecipients.client.recipientName;
            document.getElementById('recipientAddressLine1Input').value = exampleRecipients.client.recipientAddressLine1;
            document.getElementById('recipientAddressLine2Input').value = exampleRecipients.client.recipientAddressLine2;
            document.getElementById('recipientAddressLine3Input').value = exampleRecipients.client.recipientAddressLine3;
            document.getElementById('reSubjectInput').value = exampleRecipients.client.reSubject;
            document.getElementById('textBodyInput').value = exampleRecipients.client.textBody;
            break;
        }
        generatePDF()

    }


    const generateNames = (numNames, source) => {
        const firstNames = nameSources[source].first;
        const lastNames = nameSources[source].last;

        let nameArr = []
        for (let i = 0; i < numNames; i++) {
            let firstName = firstNames[Math.floor(Math.random() * firstNames.length)]
            let lastName = lastNames[Math.floor(Math.random() * lastNames.length)]
            nameArr.push(`${firstName} ${lastName}`)
        }
        variables.senderName = nameArr[Math.floor(Math.random() * nameArr.length)];
        return nameArr
    }

    variables.firmPartnersNames = generateNames(3, variables.firmPartnersSource)

    const changeNumberOfNames = () => {
        const targetNum = document.getElementById('nameNumberInput').value;
        console.log("in changeNumberOfNames with targetNum", targetNum, "and variables.firmPartnersNames.length", variables.firmPartnersNames.length)
        if (targetNum > variables.firmPartnersNames.length) {
            while (variables.firmPartnersNames.length < targetNum) {
                console.log("in while")
                variables.firmPartnersNames.push(generateNames(1, variables.firmPartnersSource)[0])
            }
        } else {
            variables.firmPartnersNames = variables.firmPartnersNames.slice(0, targetNum)
        }
        console.log(variables.firmPartnersNames)
        variables.senderName = variables.firmPartnersNames[Math.floor(Math.random() * variables.firmPartnersNames.length)];
        
        generatePDF()
    }
    
    const changeSourceOfNames = () => {
        const targetSource = document.getElementById('nameSourceInput').value;
        console.log("in changeSourceOfNames with targetSource", targetSource)
        variables.firmPartnersSource = targetSource;
        variables.firmPartnersNames = generateNames(variables.firmPartnersNames.length, targetSource)
        variables.senderName = variables.firmPartnersNames[Math.floor(Math.random() * variables.firmPartnersNames.length)];
        generatePDF()
    }


    const updateVariables = () => {
        if (document.getElementById('reSubjectInput').value) variables.reSubject = document.getElementById('reSubjectInput').value;
        if (document.getElementById('textBodyInput').value) variables.textBody = document.getElementById('textBodyInput').value;
        if (document.getElementById('recipientInput').value) variables.recipientName = document.getElementById('recipientInput').value;
        // if (document.getElementById('recipientTitleInput').value) variables.recipientTitle = document.getElementById('recipientTitleInput').value;
        if (document.getElementById('recipientAddressLine1Input').value) variables.recipientAddressLine1 = document.getElementById('recipientAddressLine1Input').value;
        if (document.getElementById('recipientAddressLine2Input').value) variables.recipientAddressLine2 = document.getElementById('recipientAddressLine2Input').value;
        if (document.getElementById('recipientAddressLine3Input').value) variables.recipientAddressLine3 = document.getElementById('recipientAddressLine3Input').value;
        if (document.getElementById('userTitleInput').value) variables.userTitle = document.getElementById('userTitleInput').value;
        if (document.getElementById('userNameInput').value) variables.userName = document.getElementById('userNameInput').value;

        variables.snootiness = document.getElementById('snootinessInput').value;
        variables.firmYear = new Date().getFullYear() - document.getElementById('firmAgeInput').value;
        //firm stuff
        variables.firmFloor = document.getElementById('firmFloorInput').value;
        variables.firmAddressLine2 = `${variables.firmFloor}${variables.firmFloor.endsWith('11') ? 'th' : variables.firmFloor.endsWith('12') ? 'th' : variables.firmFloor.endsWith('13') ? 'th' : variables.firmFloor.endsWith('1') ? 'st' : variables.firmFloor.endsWith('2') ? 'nd' : variables.firmFloor.endsWith('3') ? 'rd' : 'th'} Floor`;
        // let addressToUse = addresses[Math.floor(Math.random() * addresses.length)];
        //update firm address
        


    }

    const updateInputNumbers = () => {
        document.getElementById('snootinessNumber').innerHTML = variables.snootiness;
        document.getElementById('nameNumberNumber').innerHTML = variables.firmPartnersNames.length;
        document.getElementById('firmFloorNumber').innerHTML = variables.firmAddressLine2;
        document.getElementById('firmAgeNumber').innerHTML = `${document.getElementById('firmAgeInput').value} years`;
    }
    //GENERATION FUNCTIOND
    const makeHeader = () => {
        //first, figure out header format

        //then, make the header styling
        const header = document.getElementById('pageHeader');
        header.style.display = "flex"
        header.style.flexDirection = "column"
        header.style.justifyContent = "center"
        header.style.alignItems = "center"


        // make the firm name the last names of each partner
        let firmName = variables.firmPartnersNames.reduce((acc, cur) => {return acc + cur.split(" ")[1] + ", "}, "").toUpperCase().slice(0, -2);
        const lastCommaIndex = firmName.lastIndexOf(", ");
        console.log("lastCommaIndex", lastCommaIndex)
        if (lastCommaIndex !== -1) {
            firmName = firmName.slice(0, lastCommaIndex) + " &" + firmName.slice(lastCommaIndex + 1);
        }
        document.getElementById('firmName').innerHTML = firmName
        document.getElementById('firmYear').innerHTML = `<i>Est. ${variables.firmYear}</i>`;
        const firmAddress = document.getElementById('firmAddress');        //make the firm address the address of the firm
        document.getElementById('firmAddressLine1').innerHTML = variables.firmAddressLine1
        document.getElementById('firmAddressLine2').innerHTML = variables.firmAddressLine2
        document.getElementById('firmAddressLine3').innerHTML = variables.firmAddressLine3

        const firmPartners = document.getElementById('firmPartners');
        firmPartners.innerHTML = ""
        
        variables.firmPartnersNames.forEach(partner => {
            const partnerDiv = document.createElement('p');
            partnerDiv.classList.add("firmPartner")
            partnerDiv.innerHTML = partner;
            firmPartners.appendChild(partnerDiv);
        })
    }
    
    makeHeader();

    const makeRecipient = () => {
        const recipientAddress = document.getElementById('recipientAddress');
        const recipientName = document.getElementById('recipientName');
        const salutation = document.getElementById('salutation');

        recipientAddress.innerHTML = variables.recipientAddressLine1 + "<br/>" + variables.recipientAddressLine2 + "<br/>" + variables.recipientAddressLine3
        recipientName.innerHTML = variables.recipientName
        salutation.innerHTML = variables.salutation
    
    }

    makeRecipient();

    const makeFooter = () => {
        document.getElementById('senderSignature').innerHTML = `${variables.senderName}7`;
        document.getElementById('senderName').innerHTML = variables.senderName;
    }

    makeFooter();

    const makeBody = () => {
        const letterContent = document.getElementById('letterContent');
        const reSubject = document.getElementById('reSubject');
        const salutation = document.getElementById('salutation');
        const textBody = document.getElementById('textBody');

        reSubject.innerHTML = `<b>Re: ${variables.reSubject}</b>`
        salutation.innerHTML = variables.salutation
        // console.log("variables.textBody", variables.textBody)
        textBody.innerHTML = `${variables.textBody.replace(/\n/g, '<br/>')}`
    }

    makeBody();


    const splitCanvasIntoPages = (canvas) => {
        console.log("in splitCanvasIntoPages", typeof canvas)
        console.log("Canvas methods:", Object.getOwnPropertyNames(canvas.__proto__));
        mainCanvasContext = canvas.getContext('2d')
        console.log("mainCanvasContext", mainCanvasContext)
        mainCanvasImageData = mainCanvasContext.getImageData(0, 0, canvas.width, canvas.height)
        console.log("mainCanvasImageData", mainCanvasImageData)
        let maxIndivHeight = 2673
        let padding = 180
        let pageIncrement = maxIndivHeight - (padding * 2)
        

        let currentHeight = 0
        const pages = []
        const width = canvas.width
        const height = canvas.height
        // const pageHeight = 297
        const pageHeight = 3521
        console.log(`canvas height: ${height}\nrenderTargetHeight: ${document.getElementById('renderTarget').offsetHeight}\ncanvas width: ${width}\nrenderTargetWidth: ${document.getElementById('renderTarget').offsetWidth}`)

        //starting height is 180
        currentHeight = padding
        let currentPage = 0

        while (currentHeight < height) {

            let thisIncrement = pageIncrement
            
            let rowStart = ((currentHeight + thisIncrement) * width * 4); // Each pixel has 4 values (r,g,b,a)
            let rowEnd = rowStart + (width * 4);
            let rowPixels = mainCanvasImageData.data.slice(rowStart, rowEnd);
            let isBlack = rowPixels.some(pixel => pixel !== 255);
            // console.log("isBlack", isBlack)

            while (isBlack) {
                thisIncrement = thisIncrement - 1
                rowStart = ((currentHeight + thisIncrement) * width * 4); // Each pixel has 4 values (r,g,b,a)
                rowEnd = rowStart + (width * 4);
                rowPixels = mainCanvasImageData.data.slice(rowStart, rowEnd);
                isBlack = rowPixels.some(pixel => pixel !== 255);
            }


            const page = document.createElement('canvas')
            page.width = width
            page.height = maxIndivHeight
            const ctx = page.getContext('2d')
            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, width, maxIndivHeight);

            if (currentPage === 0) {
                ctx.drawImage(
                    canvas,
                    0, 0,  // Source x, y
                    width, thisIncrement + padding,  // Source width, height
                    0, 0,  // Destination x, y 
                    width, thisIncrement + padding   // Destination width, height
                )
            } else {
                ctx.drawImage(
                    canvas,
                    0, currentHeight,  // Source x, y
                    width, thisIncrement,  // Source width, height
                    0, 180,  // Destination x, y 
                    width, thisIncrement   // Destination width, height
                )
            }

            pages.push(page)
            currentHeight += thisIncrement
            currentPage += 1
        }


        return pages
    }


    // FUNCTIONS


    async function generatePDF() {
        updateVariables();
        updateInputNumbers();
        makeHeader();
        makeRecipient();
        makeBody();
        makeFooter();

        const content = document.getElementById('pageContent');

        const container = document.querySelector('.firmPartners');

        container.classList.remove('two-columns', 'three-columns', 'four-columns', 'five-columns');
        // container.style.fontSize = '';

        if (variables.firmPartnersNames.length > 50) {
            container.style.fontSize = '9px';
            container.classList.add('five-columns');
        } else if (variables.firmPartnersNames.length > 36) {
            container.style.fontSize = '9px';
            container.classList.add('four-columns');
        } else if (variables.firmPartnersNames.length > 20) {
            container.style.fontSize = '10px';
            container.classList.add('three-columns');
        } else if (variables.firmPartnersNames.length > 10) {
            container.style.fontSize = '10px';
            container.classList.add('two-columns');
        }
      const date = new Date();
      const options = { year: 'numeric', month: 'long', day: 'numeric' };
      document.getElementById('date').textContent = date.toLocaleDateString('en-US', options);

      const renderTarget = document.getElementById('renderTarget');
      renderTarget.style.fontFamily = fontFamily[variables.snootiness - 1];

      // You can dynamically update this however you like
      renderTarget.innerHTML = document.getElementById("content").innerHTML;

      const canvas = await html2canvas(renderTarget, { scale: 2 , autoPaging: 'text'});

      const pages = splitCanvasIntoPages(canvas)

      //clear the output container
      document.getElementById('output').innerHTML = ""
      
      //add the pages to the output container
      pages.forEach((page, index) => {
        console.log("page", page)

        let imgData = page.toDataURL('image/png');
        // make a new image element with the pdfPreview class
        const newImage = document.createElement('img');
        newImage.classList.add('pdfPreview');
        newImage.src = imgData;
        // if (index === 0) {
        //     newImage.classList.add('firstPage')
        //     newImage.onload = () => {
        //         console.log("newImage", newImage.)
        //         setPreviewMaxHeight(Math.max(newImage.height, document.getElementById('inputs').offsetHeight))
        //     }
        // }
        //append the new image to the output container
        document.getElementById('output').appendChild(newImage);

      })



    }

    async function downloadPDF() {
    generatePDF();
    const pdf = new jsPDF({
            orientation: 'portrait',
            unit: 'mm',
            format: 'a4'
        });
        

      const canvas = await html2canvas(renderTarget, { scale: 2 });
      const pages = splitCanvasIntoPages(canvas)

      pages.forEach((page, index) => {
        //add the page to the pdf
        const pdfWidth = pdf.internal.pageSize.getWidth();
        const pdfHeight = (page.height * pdfWidth) / page.width;
        let imgData = page.toDataURL('image/png');
        pdf.addImage(imgData, 'PNG', 0, 0, pdfWidth, pdfHeight);
        if (index < pages.length - 1) {
            pdf.addPage();
        }
      })



    //   pdf.addImage(imgData, 'PNG', 0, 0, pdfWidth, pdfHeight);
      stringifiedVariables = JSON.stringify(variables);
      pdf.addMetadata(stringifiedVariables, 'variables');
      pdf.save('DemandLetter_Final_2.pdf');
      fetch('https://wemakeinter.net/diyPixel/heavyweightPixel.php?event=pdfGenerated')

    }

    const uploadPDF = () => {
    const input = document.createElement('input');
    input.type = 'file';
    input.accept = 'application/pdf';
    input.onchange = async function() {
        const file = this.files[0];
        if (!file) return;

        const arrayBuffer = await file.arrayBuffer();
        const uint8Array = new Uint8Array(arrayBuffer);
        const text = new TextDecoder().decode(uint8Array);

        // Try to extract the variables metadata
        const variablesMatch = text.match(/<jspdf:metadata>([^<]*?)<\/jspdf:metadata>/);
        if (variablesMatch && variablesMatch[1]) {
            try {
                const variablesJson = JSON.parse(variablesMatch[1]);
                // Update global variables object
                variables = variablesJson;
                console.log("variables", variables)
                document.getElementById('textBodyInput').value = variables.textBody;
                document.getElementById('firmAgeInput').value = new Date().getFullYear() - variables.firmYear;
                document.getElementById('snootinessInput').value = variables.snootiness;
                document.getElementById('firmFloorInput').value = variables.firmFloor;
                document.getElementById('nameSourceInput').value = variables.firmPartnersSource;
                document.getElementById('nameNumberInput').value = variables.firmPartnersNames.length;
                document.getElementById('recipientAddressLine1Input').value = variables.recipientAddressLine1;
                document.getElementById('recipientAddressLine2Input').value = variables.recipientAddressLine2;
                document.getElementById('recipientAddressLine3Input').value = variables.recipientAddressLine3;
                document.getElementById('recipientInput').value = variables.recipientName;
                document.getElementById('reSubjectInput').value = variables.reSubject;

                updateInputNumbers();
                makeHeader();
                makeRecipient();
                makeBody();
                makeFooter();

                // Regenerate PDF with new variables
                generatePDF();
            } catch (e) {
                console.error('Failed to parse variables metadata:', e);
            }
        } else {
            console.log('No variables metadata found in PDF');
        }
    };
    input.click();


    }


    //PAGE SETUP STUFF
    const setPreviewMaxHeight = () => {
        const inputs = document.getElementById('inputs');
        const height = inputs.offsetHeight;
        const preview = document.getElementById('output');
        preview.style.maxHeight = `${height + 20}px`;
        preview.style.height = `${height + 20}px`
        preview.style.overflow = "auto"
    }


    window.onload = () => {generatePDF(); setPreviewMaxHeight()};


    document.getElementById('snootinessInput').addEventListener('change', generatePDF);
    document.getElementById('nameNumberInput').addEventListener('change', changeNumberOfNames);
    document.getElementById('firmFloorInput').addEventListener('change', generatePDF);
    document.getElementById('nameSourceInput').addEventListener('change', changeSourceOfNames);
    document.getElementById('firmAgeInput').addEventListener('change', generatePDF);
    // listen to all text inputs and generatePDF when they change
    document.querySelectorAll('input[type="text"]').forEach(input => {
        input.addEventListener('input', generatePDF);
    });
    document.querySelectorAll('textarea').forEach(textarea => {
        textarea.addEventListener('input', generatePDF);
    });
  </script>
</body>
</html>
